## 群组的增删改查

增加群组`groupadd`
- 直接添加`groupadd 群组名`
- 指定gid添加 `groupadd -g 指定的gid 群组名`
- 添加系统用户组`groupadd -r 群组名`（gid<1000为系统用户组）

查看群组

>用户群组信息文件`/etc/group`
`root:x:0:`分组名：分组密码：分组gid：加入分组的用户（可以是多个）

- 直接查看 `cat /etc/group`（全部）、`tail -n 5 /etc/group`（后五行）
- 查看指定用户的群组 `groups 用户名`

修改群组`groupmod`
- 修改指定群组的gid `groupmod -g 新的gid 群组名`
- 修改指定群组的名称`groupmod -n 新的群组名 群组名`

删除群组`groupdel`
- `groupdel 群组名`


## 用户的增删改查

增加用户`useradd 用户名`
- 创建用户时会自动创建一个和用户名相同的群组名称，作为用户的默认群组
- 会创建一个 /home/用户名 的目录，用做用户的家目录

查看用户
>用户信息的文件`/etc/passwd`
`root:x:0:0:root:/root:/bin/bash`
`用户名：密码：用户id：用户所属分组id：全名：用户家目录：用户可以登录的shell`


- 查看uid、gid `id 用户名`

修改用户`usermod`
- 修改用户家目录 `usermod -s /sbin/nologin 用户名`
- 修改用户名`usermod -l 新用户名 旧用户名`
- 修改默认群组`usermod -g 新群组 用户名`
- 添加附加组`usermod -G 新群组 用户名`
- 锁定用户`usermod -L 用户名`
- 解锁用户
	- `usermod -U 用户名`（产生没有密码的账户）
	- `usermod -p 密码 用户名`（设置密码并解锁用户）

删除用户`userdel`
- 直接删除`userdel 用户名`直接删除，不会删除用户的家目录和邮件的数据。若修改了用户的默认群组，则不会删除群组。
- 删除用户同时删除数据`userdel -r 用户名`需要注意，确保用户家目录下的数据已经备份或者是无用的数据。

## 用户密码

>用户密码文件`/etc/shadow`
`bin:*:17110:0:99999:7:::`用户名：加密后的密码：最后一次更改密码的时间：密码不能被修改的天数：密码在多少天之内必须修改：密码到期之前几天给用户发提醒：密码过期后的宽限天数：用户失效日期：保留位置
修改属性`passwd[选项]<用户名称>`
交互方式修改密码属性`chage 用户名`按提示一步步操作即可

- 重置密码`passwd`
- 重置其他用户的密码`passwd 用户名`（只有root用户有权限设置）
- 锁定/解锁密码`passwd -l/u 用户名`（只有root用户有权限设置）
- 静默方式重置密码` echo 1 | passwd --stdin test`这种方式会将密码明文显示出来，所以一般都是脚本中批量初始化用户时使用

## 用户切换
`su` 切换用户
- 此命令root 用户切换到其他用户的时候不需要密码，普通用户切换到其他用户的时候需要密码
- 保留当前用户的环境变量。如root切换到test时还会保留root的环境变量

`su -`切换用户
- 普通用户切换到其他用户的时候需要密码
- 使用新的环境变量。如root切换到test时使用test的环境变量

`su - 用户 -C "命令"` 临时使用其他用户权限执行命令
- 如 `su - root -C "ls"`  临时使用root用户权限执行ls命令（需要对方用户的密码）

`sudo`切换用户
sudo 是普通帐号用来执行管理员命令和切换到root帐号使用的。此方式能减少 root 用户的操作，尽可能的避免误操作。推荐
>设置sudo权限
1. 将普通用户加入到` wheel `群组 `usermod -G wheel 用户名`。
- wheel 这个群组是从UNIX继承过来的，系统内置的一个比较特殊的群组，拥有这个群组权限的用户，就可以拥有 sudo 权限。
- 注意，**分配群组需要 root 用户来操作**。
2. 修改` /etc/sudoers` 配置文件。用文本编辑器编辑` /etc/sudoers` 这个文件，然后在 `root ALL=(ALL) ALL` 下面加上一行 `用户名 ALL=(ALL) ALL `

用法：操作前加sudo关键字
设置好权限后被设置的用户就可以执行只有 root 权限才可以执行的操作了。比如查看/etc/shadow 这个文件，`sudo cat /etc/shadow`。如果执行了一个越权的操作，忘记加sudo，可以直接打`sudo !!`。系统会自动转换为`sudo 上次操作命令`

普通用户通过 sudo 命令切换到 root 用户
- `sudo -s`这个命令相当于 `su root`，还会携带当前用户的环境变量。不需要知道 root 的密码。
- `sudo -i`这个命令相当于 `su - root`，会初始化 root 用户的环境变量。不需要知道 root 的密码。