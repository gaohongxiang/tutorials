## 消息调用

合约可以通过消息调用的方式来调用其他合约，或者发送以太币到非合约账户。

消息调用包含一个源、一个目标、数据负载（payload）、以太币、gas（费用）、和返回数据。

事实上，每笔交易都可以被认为时一个顶层的消息调用，这个消息调用会溢出产生更多的消息调用。

当合约调用时，被调用的合约会拥有崭新的内存，以及能够访问调用的payload（由称为calldata的独立区域所提供的数据）。当调用执行结束后，返回数据将被存储在调用者预先分配好的一块内存中。

调用层数被限制为1024，因此，对于更加复杂的操作，我们应该使用循环而不是递归。

## 委托调用（delegatecall）和 库

委托调用是一种特殊的消息调用。跟消息调用基本一样，不同之处在于它将目标地址的代码加载到发起调用的合约上下文环境中来执行，并且msg.sender和msg.value不变。

例如：A调用B，B委托调用C，此时msg.sender为A。而如果是普通调用，则msg.sender为B。

这意味着一个合约在运行时可以从另一个地址动态的加载代码。存储当前地址和余额都指向发起调用的合约，只有代码是从调用地址获取的。这使得Solidity可以实现库能力。